<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/max-messenger-miniapp/src/components/organisms/Statistics/Statistics.tsx">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/max-messenger-miniapp/src/components/organisms/Statistics/Statistics.tsx" />
              <option name="originalContent" value="import React, { useState, useEffect } from 'react';&#10;import { Panel, Button } from '@maxhub/max-ui';&#10;import type { Task } from '../../../types';&#10;import './Statistics.css';&#10;&#10;interface StatisticsProps {&#10;  tasks: Task[];&#10;}&#10;&#10;type Period = 'week' | 'month' | 'year';&#10;&#10;const Statistics: React.FC&lt;StatisticsProps&gt; = ({ tasks }) =&gt; {&#10;  const [period, setPeriod] = useState&lt;Period&gt;('week');&#10;  const [animatedPercentage, setAnimatedPercentage] = useState(0);&#10;  const [isInitialLoad, setIsInitialLoad] = useState(true);&#10;&#10;  const getFilteredTasks = () =&gt; {&#10;    const now = new Date();&#10;    let startDate: Date;&#10;&#10;    switch (period) {&#10;      case 'week':&#10;        startDate = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);&#10;        break;&#10;      case 'month':&#10;        startDate = new Date(now.getFullYear(), now.getMonth(), 1);&#10;        break;&#10;      case 'year':&#10;        startDate = new Date(now.getFullYear(), 0, 1);&#10;        break;&#10;    }&#10;&#10;    return tasks.filter(task =&gt; {&#10;      const createdDate = new Date(task.createdAt);&#10;      return createdDate &gt;= startDate;&#10;    });&#10;  };&#10;&#10;  const filteredTasks = getFilteredTasks();&#10;  const completedTasks = filteredTasks.filter(t =&gt; t.status === 'completed');&#10;  const completionPercentage = filteredTasks.length &gt; 0&#10;    ? Math.round((completedTasks.length / filteredTasks.length) * 100)&#10;    : 0;&#10;&#10;  const getMostProductiveDay = () =&gt; {&#10;    const dayCount: { [key: string]: number } = {};&#10;&#10;    completedTasks.forEach(task =&gt; {&#10;      const date = new Date(task.createdAt);&#10;      const dayName = date.toLocaleDateString('ru-RU', { weekday: 'long' });&#10;      dayCount[dayName] = (dayCount[dayName] || 0) + 1;&#10;    });&#10;&#10;    const entries = Object.entries(dayCount);&#10;    if (entries.length === 0) return 'Нет данных';&#10;&#10;    const [day, count] = entries.reduce((a, b) =&gt; a[1] &gt; b[1] ? a : b);&#10;    return `${day.charAt(0).toUpperCase() + day.slice(1)} (${count})`;&#10;  };&#10;&#10;  // Animate percentage on load and period change&#10;  useEffect(() =&gt; {&#10;    const duration = isInitialLoad ? 1000 : 500;&#10;    const steps = 60;&#10;    const increment = completionPercentage / steps;&#10;    let current = 0;&#10;    const timer = setInterval(() =&gt; {&#10;      current += increment;&#10;      if (current &gt;= completionPercentage) {&#10;        setAnimatedPercentage(completionPercentage);&#10;        clearInterval(timer);&#10;        if (isInitialLoad) setIsInitialLoad(false);&#10;      } else {&#10;        setAnimatedPercentage(Math.floor(current));&#10;      }&#10;    }, duration / steps);&#10;&#10;    return () =&gt; clearInterval(timer);&#10;  }, [completionPercentage, isInitialLoad]);&#10;&#10;  const circumference = 2 * Math.PI * 70; // radius = 70&#10;  const strokeDashoffset = circumference - (animatedPercentage / 100) * circumference;&#10;&#10;  return (&#10;    &lt;Panel className=&quot;statistics-panel&quot;&gt;&#10;      {/* Header */}&#10;      &lt;div className=&quot;statistics-header&quot;&gt;&#10;        &lt;h2 className=&quot;statistics-title&quot;&gt;Статистика&lt;/h2&gt;&#10;&#10;        &lt;div className=&quot;segmented-control&quot;&gt;&#10;          &lt;Button&#10;            mode=&quot;tertiary&quot;&#10;            className={`segmented-btn ${period === 'week' ? 'active' : ''}`}&#10;            onClick={() =&gt; setPeriod('week')}&#10;          &gt;&#10;            Неделя&#10;          &lt;/Button&gt;&#10;          &lt;Button&#10;            mode=&quot;tertiary&quot;&#10;            className={`segmented-btn ${period === 'month' ? 'active' : ''}`}&#10;            onClick={() =&gt; setPeriod('month')}&#10;          &gt;&#10;            Месяц&#10;          &lt;/Button&gt;&#10;          &lt;Button&#10;            mode=&quot;tertiary&quot;&#10;            className={`segmented-btn ${period === 'year' ? 'active' : ''}`}&#10;            onClick={() =&gt; setPeriod('year')}&#10;          &gt;&#10;            Год&#10;          &lt;/Button&gt;&#10;        &lt;/div&gt;&#10;      &lt;/div&gt;&#10;&#10;      {/* Progress Circle */}&#10;      &lt;div className=&quot;progress-circle-container&quot;&gt;&#10;        &lt;svg className=&quot;progress-circle&quot; viewBox=&quot;0 0 160 160&quot;&gt;&#10;          &lt;defs&gt;&#10;            &lt;linearGradient id=&quot;progressGradient&quot; x1=&quot;0%&quot; y1=&quot;0%&quot; x2=&quot;100%&quot; y2=&quot;100%&quot;&gt;&#10;              &lt;stop offset=&quot;0%&quot; stopColor=&quot;#9484e3&quot; /&gt;&#10;              &lt;stop offset=&quot;100%&quot; stopColor=&quot;#7E6FD5&quot; /&gt;&#10;            &lt;/linearGradient&gt;&#10;          &lt;/defs&gt;&#10;&#10;          {/* Background circle */}&#10;          &lt;circle&#10;            cx=&quot;80&quot;&#10;            cy=&quot;80&quot;&#10;            r=&quot;70&quot;&#10;            fill=&quot;none&quot;&#10;            stroke=&quot;var(--surface-gray)&quot;&#10;            strokeWidth=&quot;12&quot;&#10;            opacity=&quot;0.2&quot;&#10;          /&gt;&#10;&#10;          {/* Progress circle */}&#10;          &lt;circle&#10;            cx=&quot;80&quot;&#10;            cy=&quot;80&quot;&#10;            r=&quot;70&quot;&#10;            fill=&quot;none&quot;&#10;            stroke=&quot;url(#progressGradient)&quot;&#10;            strokeWidth=&quot;12&quot;&#10;            strokeLinecap=&quot;round&quot;&#10;            strokeDasharray={circumference}&#10;            strokeDashoffset={strokeDashoffset}&#10;            transform=&quot;rotate(-90 80 80)&quot;&#10;            className=&quot;progress-circle-stroke&quot;&#10;          /&gt;&#10;        &lt;/svg&gt;&#10;&#10;        &lt;div className=&quot;progress-percentage&quot;&gt;&#10;          {animatedPercentage}&lt;span className=&quot;percent-sign&quot;&gt;%&lt;/span&gt;&#10;        &lt;/div&gt;&#10;      &lt;/div&gt;&#10;&#10;      {/* Key Metrics */}&#10;      &lt;div className=&quot;metrics-list&quot;&gt;&#10;        &lt;div className=&quot;metric-item&quot;&gt;&#10;          &lt;div className=&quot;metric-icon&quot;&gt;&#10;            &lt;svg viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; strokeWidth=&quot;2&quot;&gt;&#10;              &lt;path d=&quot;M22 11.08V12a10 10 0 1 1-5.93-9.14&quot; /&gt;&#10;              &lt;polyline points=&quot;22 4 12 14.01 9 11.01&quot; /&gt;&#10;            &lt;/svg&gt;&#10;          &lt;/div&gt;&#10;          &lt;div className=&quot;metric-content&quot;&gt;&#10;            &lt;span className=&quot;metric-label&quot;&gt;Задач выполнено&lt;/span&gt;&#10;          &lt;/div&gt;&#10;          &lt;div className=&quot;metric-value&quot;&gt;{completedTasks.length}&lt;/div&gt;&#10;        &lt;/div&gt;&#10;&#10;        &lt;div className=&quot;metric-item&quot;&gt;&#10;          &lt;div className=&quot;metric-icon&quot;&gt;&#10;            &lt;svg viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; strokeWidth=&quot;2&quot;&gt;&#10;              &lt;rect x=&quot;3&quot; y=&quot;4&quot; width=&quot;18&quot; height=&quot;18&quot; rx=&quot;2&quot; ry=&quot;2&quot; /&gt;&#10;              &lt;line x1=&quot;16&quot; y1=&quot;2&quot; x2=&quot;16&quot; y2=&quot;6&quot; /&gt;&#10;              &lt;line x1=&quot;8&quot; y1=&quot;2&quot; x2=&quot;8&quot; y2=&quot;6&quot; /&gt;&#10;              &lt;line x1=&quot;3&quot; y1=&quot;10&quot; x2=&quot;21&quot; y2=&quot;10&quot; /&gt;&#10;            &lt;/svg&gt;&#10;          &lt;/div&gt;&#10;          &lt;div className=&quot;metric-content&quot;&gt;&#10;            &lt;span className=&quot;metric-label&quot;&gt;Самый продуктивный день&lt;/span&gt;&#10;          &lt;/div&gt;&#10;          &lt;div className=&quot;metric-value metric-value-text&quot;&gt;{getMostProductiveDay()}&lt;/div&gt;&#10;        &lt;/div&gt;&#10;&#10;        &lt;div className=&quot;metric-item&quot;&gt;&#10;          &lt;div className=&quot;metric-icon&quot;&gt;&#10;            &lt;svg viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; strokeWidth=&quot;2&quot;&gt;&#10;              &lt;line x1=&quot;12&quot; y1=&quot;1&quot; x2=&quot;12&quot; y2=&quot;23&quot; /&gt;&#10;              &lt;path d=&quot;M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6&quot; /&gt;&#10;            &lt;/svg&gt;&#10;          &lt;/div&gt;&#10;          &lt;div className=&quot;metric-content&quot;&gt;&#10;            &lt;span className=&quot;metric-label&quot;&gt;Всего задач&lt;/span&gt;&#10;          &lt;/div&gt;&#10;          &lt;div className=&quot;metric-value&quot;&gt;{filteredTasks.length}&lt;/div&gt;&#10;        &lt;/div&gt;&#10;      &lt;/div&gt;&#10;    &lt;/Panel&gt;&#10;  );&#10;};&#10;&#10;export default Statistics;&#10;&#10;" />
              <option name="updatedContent" value="import React, { useState, useEffect } from 'react';&#10;import { Panel, Button } from '@maxhub/max-ui';&#10;import type { Task } from '../../../types';&#10;import './Statistics.css';&#10;&#10;interface StatisticsProps {&#10;  tasks: Task[];&#10;}&#10;&#10;type Period = 'week' | 'month' | 'year';&#10;&#10;const Statistics: React.FC&lt;StatisticsProps&gt; = ({ tasks }) =&gt; {&#10;  const [period, setPeriod] = useState&lt;Period&gt;('week');&#10;  const [animatedPercentage, setAnimatedPercentage] = useState(0);&#10;  const [isInitialLoad, setIsInitialLoad] = useState(true);&#10;&#10;  const getFilteredTasks = () =&gt; {&#10;    const now = new Date();&#10;    let startDate: Date;&#10;&#10;    switch (period) {&#10;      case 'week':&#10;        startDate = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);&#10;        break;&#10;      case 'month':&#10;        startDate = new Date(now.getFullYear(), now.getMonth(), 1);&#10;        break;&#10;      case 'year':&#10;        startDate = new Date(now.getFullYear(), 0, 1);&#10;        break;&#10;    }&#10;&#10;    return tasks.filter(task =&gt; {&#10;      const createdDate = new Date(task.createdAt);&#10;      return createdDate &gt;= startDate;&#10;    });&#10;  };&#10;&#10;  const filteredTasks = getFilteredTasks();&#10;  const completedTasks = filteredTasks.filter(t =&gt; t.status === 'completed');&#10;  const completionPercentage = filteredTasks.length &gt; 0&#10;    ? Math.round((completedTasks.length / filteredTasks.length) * 100)&#10;    : 0;&#10;&#10;  const getMostProductiveDay = () =&gt; {&#10;    const dayCount: { [key: string]: number } = {};&#10;&#10;    completedTasks.forEach(task =&gt; {&#10;      const date = new Date(task.createdAt);&#10;      const dayName = date.toLocaleDateString('ru-RU', { weekday: 'long' });&#10;      dayCount[dayName] = (dayCount[dayName] || 0) + 1;&#10;    });&#10;&#10;    const entries = Object.entries(dayCount);&#10;    if (entries.length === 0) return 'Нет данных';&#10;&#10;    const [day, count] = entries.reduce((a, b) =&gt; a[1] &gt; b[1] ? a : b);&#10;    return `${day.charAt(0).toUpperCase() + day.slice(1)} (${count})`;&#10;  };&#10;&#10;  // Animate percentage on load and period change&#10;  useEffect(() =&gt; {&#10;    const duration = isInitialLoad ? 1000 : 500;&#10;    const steps = 60;&#10;    const increment = completionPercentage / steps;&#10;    let current = 0;&#10;    const timer = setInterval(() =&gt; {&#10;      current += increment;&#10;      if (current &gt;= completionPercentage) {&#10;        setAnimatedPercentage(completionPercentage);&#10;        clearInterval(timer);&#10;        if (isInitialLoad) setIsInitialLoad(false);&#10;      } else {&#10;        setAnimatedPercentage(Math.floor(current));&#10;      }&#10;    }, duration / steps);&#10;&#10;    return () =&gt; clearInterval(timer);&#10;  }, [completionPercentage, isInitialLoad]);&#10;&#10;  const circumference = 2 * Math.PI * 70; // radius = 70&#10;  const strokeDashoffset = circumference - (animatedPercentage / 100) * circumference;&#10;&#10;  return (&#10;    &lt;Panel className=&quot;statistics-panel&quot;&gt;&#10;      {/* Header */}&#10;      &lt;div className=&quot;statistics-header&quot;&gt;&#10;        &lt;h2 className=&quot;statistics-title&quot;&gt;Статистика&lt;/h2&gt;&#10;&#10;        &lt;div className=&quot;segmented-control&quot;&gt;&#10;          &lt;Button&#10;            mode=&quot;tertiary&quot;&#10;            className={`segmented-btn ${period === 'week' ? 'active' : ''}`}&#10;            onClick={() =&gt; setPeriod('week')}&#10;          &gt;&#10;            Неделя&#10;          &lt;/Button&gt;&#10;          &lt;Button&#10;            mode=&quot;tertiary&quot;&#10;            className={`segmented-btn ${period === 'month' ? 'active' : ''}`}&#10;            onClick={() =&gt; setPeriod('month')}&#10;          &gt;&#10;            Месяц&#10;          &lt;/Button&gt;&#10;          &lt;Button&#10;            mode=&quot;tertiary&quot;&#10;            className={`segmented-btn ${period === 'year' ? 'active' : ''}`}&#10;            onClick={() =&gt; setPeriod('year')}&#10;          &gt;&#10;            Год&#10;          &lt;/Button&gt;&#10;        &lt;/div&gt;&#10;      &lt;/div&gt;&#10;&#10;      {/* Progress Circle - Donut Chart */}&#10;      &lt;div className=&quot;progress-circle-container&quot;&gt;&#10;        &lt;svg className=&quot;progress-circle&quot; viewBox=&quot;0 0 160 160&quot;&gt;&#10;          &lt;defs&gt;&#10;            {/* Main gradient for progress */}&#10;            &lt;linearGradient id=&quot;progressGradient&quot; x1=&quot;0%&quot; y1=&quot;0%&quot; x2=&quot;100%&quot; y2=&quot;100%&quot;&gt;&#10;              &lt;stop offset=&quot;0%&quot; stopColor=&quot;#9484e3&quot; /&gt;&#10;              &lt;stop offset=&quot;100%&quot; stopColor=&quot;#7E6FD5&quot; /&gt;&#10;            &lt;/linearGradient&gt;&#10;            &#10;            {/* Subtle glow effect */}&#10;            &lt;filter id=&quot;glowEffect&quot;&gt;&#10;              &lt;feGaussianBlur stdDeviation=&quot;2&quot; result=&quot;coloredBlur&quot; /&gt;&#10;              &lt;feMerge&gt;&#10;                &lt;feMergeNode in=&quot;coloredBlur&quot; /&gt;&#10;                &lt;feMergeNode in=&quot;SourceGraphic&quot; /&gt;&#10;              &lt;/feMerge&gt;&#10;            &lt;/filter&gt;&#10;          &lt;/defs&gt;&#10;&#10;          {/* Background circle (track) */}&#10;          &lt;circle&#10;            cx=&quot;80&quot;&#10;            cy=&quot;80&quot;&#10;            r=&quot;70&quot;&#10;            fill=&quot;none&quot;&#10;            stroke=&quot;#4a4a52&quot;&#10;            strokeWidth=&quot;14&quot;&#10;            opacity=&quot;0.3&quot;&#10;            className=&quot;progress-track&quot;&#10;          /&gt;&#10;&#10;          {/* Progress circle with animation */}&#10;          &lt;circle&#10;            cx=&quot;80&quot;&#10;            cy=&quot;80&quot;&#10;            r=&quot;70&quot;&#10;            fill=&quot;none&quot;&#10;            stroke=&quot;url(#progressGradient)&quot;&#10;            strokeWidth=&quot;14&quot;&#10;            strokeLinecap=&quot;round&quot;&#10;            strokeDasharray={circumference}&#10;            strokeDashoffset={strokeDashoffset}&#10;            transform=&quot;rotate(-90 80 80)&quot;&#10;            className=&quot;progress-circle-stroke&quot;&#10;            filter=&quot;url(#glowEffect)&quot;&#10;          /&gt;&#10;        &lt;/svg&gt;&#10;&#10;        {/* Center percentage text */}&#10;        &lt;div className=&quot;progress-percentage&quot;&gt;&#10;          &lt;span className=&quot;percentage-number&quot;&gt;{animatedPercentage}&lt;/span&gt;&#10;          &lt;span className=&quot;percent-sign&quot;&gt;%&lt;/span&gt;&#10;        &lt;/div&gt;&#10;      &lt;/div&gt;&#10;&#10;      {/* Key Metrics */}&#10;      &lt;div className=&quot;metrics-list&quot;&gt;&#10;        &lt;div className=&quot;metric-item&quot;&gt;&#10;          &lt;div className=&quot;metric-icon&quot;&gt;&#10;            &lt;svg viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; strokeWidth=&quot;2&quot;&gt;&#10;              &lt;path d=&quot;M22 11.08V12a10 10 0 1 1-5.93-9.14&quot; /&gt;&#10;              &lt;polyline points=&quot;22 4 12 14.01 9 11.01&quot; /&gt;&#10;            &lt;/svg&gt;&#10;          &lt;/div&gt;&#10;          &lt;div className=&quot;metric-content&quot;&gt;&#10;            &lt;span className=&quot;metric-label&quot;&gt;Задач выполнено&lt;/span&gt;&#10;          &lt;/div&gt;&#10;          &lt;div className=&quot;metric-value&quot;&gt;{completedTasks.length}&lt;/div&gt;&#10;        &lt;/div&gt;&#10;&#10;        &lt;div className=&quot;metric-item&quot;&gt;&#10;          &lt;div className=&quot;metric-icon&quot;&gt;&#10;            &lt;svg viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; strokeWidth=&quot;2&quot;&gt;&#10;              &lt;rect x=&quot;3&quot; y=&quot;4&quot; width=&quot;18&quot; height=&quot;18&quot; rx=&quot;2&quot; ry=&quot;2&quot; /&gt;&#10;              &lt;line x1=&quot;16&quot; y1=&quot;2&quot; x2=&quot;16&quot; y2=&quot;6&quot; /&gt;&#10;              &lt;line x1=&quot;8&quot; y1=&quot;2&quot; x2=&quot;8&quot; y2=&quot;6&quot; /&gt;&#10;              &lt;line x1=&quot;3&quot; y1=&quot;10&quot; x2=&quot;21&quot; y2=&quot;10&quot; /&gt;&#10;            &lt;/svg&gt;&#10;          &lt;/div&gt;&#10;          &lt;div className=&quot;metric-content&quot;&gt;&#10;            &lt;span className=&quot;metric-label&quot;&gt;Самый продуктивный день&lt;/span&gt;&#10;          &lt;/div&gt;&#10;          &lt;div className=&quot;metric-value metric-value-text&quot;&gt;{getMostProductiveDay()}&lt;/div&gt;&#10;        &lt;/div&gt;&#10;&#10;        &lt;div className=&quot;metric-item&quot;&gt;&#10;          &lt;div className=&quot;metric-icon&quot;&gt;&#10;            &lt;svg viewBox=&quot;0 0 24 24&quot; fill=&quot;none&quot; stroke=&quot;currentColor&quot; strokeWidth=&quot;2&quot;&gt;&#10;              &lt;line x1=&quot;12&quot; y1=&quot;1&quot; x2=&quot;12&quot; y2=&quot;23&quot; /&gt;&#10;              &lt;path d=&quot;M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6&quot; /&gt;&#10;            &lt;/svg&gt;&#10;          &lt;/div&gt;&#10;          &lt;div className=&quot;metric-content&quot;&gt;&#10;            &lt;span className=&quot;metric-label&quot;&gt;Всего задач&lt;/span&gt;&#10;          &lt;/div&gt;&#10;          &lt;div className=&quot;metric-value&quot;&gt;{filteredTasks.length}&lt;/div&gt;&#10;        &lt;/div&gt;&#10;      &lt;/div&gt;&#10;    &lt;/Panel&gt;&#10;  );&#10;};&#10;&#10;export default Statistics;&#10;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>